<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Invitación — Cristhian & Diana</title>
  <style>
    :root{
      --bg1:#0b0b10;
      --bg2:#16121f;
      --paper:#fbf6ee;
      --paper2:#f2eadf;
      --ink:#121212;
      --gold:#c9a86a;
      --gold2:#b08545;
      --shadow: 0 30px 70px rgba(0,0,0,.55);
      --shadow2: 0 14px 40px rgba(0,0,0,.35);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      color:#eae7e2;
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      background:
        radial-gradient(900px 420px at 20% 15%, rgba(201,168,106,.18), transparent 55%),
        radial-gradient(700px 380px at 85% 80%, rgba(167,133,255,.14), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    .wrap{
      width:min(560px, 92vw);
      text-align:center;
    }

    .hint{
      margin: 0 0 18px;
      opacity:.9;
      letter-spacing:.06em;
      font-size: 12px;
      text-transform: uppercase;
    }

    .stage{
      position:relative;
      width:min(520px, 92vw);
      height:min(360px, 62vh);
      margin:0 auto;
      display:grid;
      place-items:center;
      isolation:isolate;
    }

    /* subtle sparkles */
    .sparkle{
      position:absolute;
      inset:-40px;
      pointer-events:none;
      background-image:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.18) 0 2px, transparent 3px),
        radial-gradient(circle at 78% 22%, rgba(255,255,255,.12) 0 1.5px, transparent 3px),
        radial-gradient(circle at 62% 68%, rgba(255,255,255,.10) 0 2px, transparent 4px),
        radial-gradient(circle at 35% 78%, rgba(255,255,255,.12) 0 1.5px, transparent 3px);
      filter: blur(.3px);
      opacity:.55;
      animation: twinkle 3.2s ease-in-out infinite;
      z-index: 1;
    }
    @keyframes twinkle{
      0%,100%{transform:translateY(0);opacity:.45}
      50%{transform:translateY(-6px);opacity:.65}
    }

    .envelope{
      position:relative;
      width:min(420px, 92vw);
      height:260px;
      cursor:pointer;
      transform: translateZ(0);
      filter: drop-shadow(var(--shadow));
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      z-index: 5;
    }

    /* Back body */
    .env-body{
      position:absolute;
      inset:0;
      border-radius: var(--radius);
      background:
        linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
        radial-gradient(120% 160% at 30% 0%, rgba(201,168,106,.22), transparent 55%),
        linear-gradient(160deg, #1f1c27, #17141f);
      border: 1px solid rgba(255,255,255,.08);
      overflow:hidden;
    }

    /* Inner lining */
    .env-lining{
      position:absolute;
      inset:10px;
      border-radius: calc(var(--radius) - 10px);
      background:
        radial-gradient(120% 100% at 10% 15%, rgba(201,168,106,.12), transparent 50%),
        radial-gradient(110% 100% at 90% 90%, rgba(167,133,255,.10), transparent 55%),
        linear-gradient(145deg, rgba(255,255,255,.04), rgba(255,255,255,.01));
      border:1px solid rgba(255,255,255,.06);
    }

    /* Card */
    .card{
      position:absolute;
      left: 50%;
      top: 22px;
      width: 92%;
      max-width: 390px;
      height: 210px;
      transform: translate(-50%, 90px) rotate(-.6deg);
      border-radius: 16px;
      background:
        radial-gradient(160px 120px at 20% 20%, rgba(201,168,106,.18), transparent 70%),
        linear-gradient(180deg, var(--paper), var(--paper2));
      color: var(--ink);
      box-shadow: var(--shadow2);
      padding: 18px 18px 16px;
      opacity:0;
      z-index: 20;
      transition: transform 1.15s cubic-bezier(.2,.9,.15,1), opacity .85s ease;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      overflow:hidden;
    }

    .card:before{
      content:"";
      position:absolute;
      inset:0;
      background-image:
        radial-gradient(circle at 25% 30%, rgba(0,0,0,.04) 0 1px, transparent 2px),
        radial-gradient(circle at 70% 65%, rgba(0,0,0,.035) 0 1px, transparent 2px);
      opacity:.25;
      pointer-events:none;
    }

    .names{
      font-size: 26px;
      letter-spacing:.02em;
      margin:0;
      line-height:1.15;
    }
    .date{
      margin:10px 0 0;
      font-size: 13px;
      letter-spacing:.22em;
      text-transform: uppercase;
      opacity:.75;
    }
    .cta{
      margin: 14px 0 0;
      font-size: 12px;
      letter-spacing:.12em;
      text-transform: uppercase;
      opacity:.7;
    }

    /* Pocket (front) */
    .pocket{
      position:absolute;
      inset:0;
      border-radius: var(--radius);
      overflow:hidden;
      z-index: 30;
      pointer-events:none;
    }

    .pocket:before{
      content:"";
      position:absolute;
      inset:0;
      background:
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,0)),
        linear-gradient(135deg, rgba(0,0,0,.24), rgba(0,0,0,0));
      opacity:.85;
    }

    /* Left/Right triangles to form pocket */
    .tri-left, .tri-right{
      position:absolute;
      bottom:0;
      width: 60%;
      height: 78%;
      background: linear-gradient(135deg, rgba(255,255,255,.07), rgba(255,255,255,.02));
      border-top: 1px solid rgba(255,255,255,.08);
    }
    .tri-left{
      left:0;
      clip-path: polygon(0 100%, 100% 100%, 0 0);
      border-right: 1px solid rgba(255,255,255,.08);
    }
    .tri-right{
      right:0;
      clip-path: polygon(100% 100%, 0 100%, 100% 0);
      border-left: 1px solid rgba(255,255,255,.08);
    }

    .tri-bottom{
      position:absolute;
      bottom:0;
      left:0;
      width:100%;
      height: 70%;
      background: linear-gradient(160deg, rgba(255,255,255,.07), rgba(255,255,255,.015));
      clip-path: polygon(0 100%, 100% 100%, 50% 35%);
      border-top: 1px solid rgba(255,255,255,.08);
    }

    /* Flap */
    .flap{
      position:absolute;
      inset:0;
      border-radius: var(--radius);
      transform-origin: top center;
      transform: rotateX(0deg);
      transition: transform 1.2s cubic-bezier(.2,.9,.15,1);
      z-index: 40; /* on top when closed */
      pointer-events:none;
      backface-visibility:hidden;
    }
    .flap:before{
      content:"";
      position:absolute;
      inset:0;
      background:
        linear-gradient(135deg, rgba(255,255,255,.09), rgba(255,255,255,.02)),
        radial-gradient(120% 100% at 50% 0%, rgba(201,168,106,.22), transparent 55%),
        linear-gradient(160deg, #232031, #17141f);
      clip-path: polygon(0 0, 100% 0, 50% 58%);
      border-top-left-radius: var(--radius);
      border-top-right-radius: var(--radius);
      border-bottom: 1px solid rgba(255,255,255,.10);
    }

    /* Wax seal */
    .seal{
      position:absolute;
      left:50%;
      bottom: 46px;
      width: 54px;
      height: 54px;
      transform: translateX(-50%);
      border-radius: 999px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), transparent 45%),
        radial-gradient(circle at 70% 70%, rgba(0,0,0,.25), transparent 55%),
        linear-gradient(135deg, var(--gold2), var(--gold));
      box-shadow: 0 10px 20px rgba(0,0,0,.35);
      z-index: 45;
      display:grid;
      place-items:center;
      letter-spacing:.08em;
      color: rgba(20,12,5,.85);
      font-weight:700;
      font-size: 14px;
      transition: transform .55s ease, opacity .55s ease, filter .55s ease;
      overflow:hidden;
    }
    .seal:after{
      content:"";
      position:absolute;
      inset:6px;
      border-radius:999px;
      border: 1px dashed rgba(18,18,18,.25);
      opacity:.65;
    }

    /* Two halves to "break" */
    .seal .half{
      position:absolute;
      inset:0;
      display:block;
      background: inherit;
      border-radius: 999px;
      mix-blend-mode: normal;
      pointer-events:none;
    }
    .seal .half.left{
      clip-path: polygon(0 0, 52% 0, 48% 100%, 0 100%);
    }
    .seal .half.right{
      clip-path: polygon(52% 0, 100% 0, 100% 100%, 48% 100%);
    }
    .seal .monogram{
      position:relative;
      z-index:2;
    }
    .seal-break{
      position:absolute;
      left:50%;
      top:50%;
      width:2px;
      height:70%;
      transform: translate(-50%,-50%) rotate(2deg);
      background: rgba(30,18,7,.35);
      filter: blur(.15px);
      opacity:0;
      z-index:3;
    }

    /* Particles */
    .particles{
      position:absolute;
      inset:0;
      pointer-events:none;
      z-index: 60;
    }
    .p{
      position:absolute;
      width:6px;
      height:6px;
      border-radius:999px;
      background: radial-gradient(circle, rgba(255,255,255,.95), rgba(255,255,255,0) 70%);
      opacity:0;
      animation: pop 900ms ease-out forwards;
      filter: drop-shadow(0 6px 12px rgba(0,0,0,.35));
    }
    @keyframes pop{
      0%{transform: translate(var(--x0), var(--y0)) scale(.7); opacity:0}
      12%{opacity:1}
      100%{transform: translate(var(--x1), var(--y1)) scale(.9); opacity:0}
    }

    /* Open state */
    .envelope.open .flap{
      transform: rotateX(180deg);
      z-index: 10; /* goes behind card so it doesn't overlap */
    }
    .envelope.open .card{
      opacity:1;
      transform: translate(-50%, -32px) rotate(.2deg);
    }

    /* Seal break animation */
    .envelope.breaking .seal{
      filter: brightness(1.05);
    }
    .envelope.breaking .seal-break{
      opacity:.9;
      transition: opacity .2s ease;
    }
    .envelope.open .seal{
      opacity:0;
      transform: translateX(-50%) scale(.9);
    }
    .envelope.breaking .seal .half.left{
      animation: splitL 520ms ease-out forwards;
    }
    .envelope.breaking .seal .half.right{
      animation: splitR 520ms ease-out forwards;
    }
    @keyframes splitL{
      to{transform: translateX(-9px) rotate(-10deg); opacity:.25}
    }
    @keyframes splitR{
      to{transform: translateX(9px) rotate(10deg); opacity:.25}
    }

    /* Micro interaction */
    .envelope:hover .env-body{filter: brightness(1.04);}
    .envelope:hover{transform: translateY(-2px); transition: transform .25s ease;}
    .envelope:active{transform: translateY(1px);}

    .footer{
      margin-top: 14px;
      font-size: 12px;
      opacity:.78;
    }

    .footer span{
      color: var(--gold);
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .sparkle, .p, .envelope, .card, .flap{animation:none!important; transition:none!important;}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <p class="hint">Toca el sobre para abrir la invitación</p>

    <div class="stage">
      <div class="sparkle"></div>
      <div class="particles" id="particles"></div>

      <div class="envelope" id="env" onclick="openInvite()" aria-label="Abrir invitación">
        <div class="env-body"></div>
        <div class="env-lining"></div>

        <div class="card" role="dialog" aria-live="polite">
          <div>
            <p class="names">Cristhian & Diana</p>
            <p class="date">12 · 09 · 2026</p>
            <p class="cta">Abrir invitación</p>
          </div>
        </div>

        <div class="pocket">
          <div class="tri-left"></div>
          <div class="tri-right"></div>
          <div class="tri-bottom"></div>
        </div>

        <div class="flap"></div>

        <div class="seal" aria-hidden="true">
          <span class="half left"></span>
          <span class="half right"></span>
          <span class="seal-break"></span>
          <span class="monogram">C&amp;D</span>
        </div>
      </div>
    </div>

    <div class="footer">Un toque y… <span>magia</span> ✨</div>
  </div>

  <script>
    let opened = false;

    // Click suave con Web Audio (sin archivos, funciona offline)
    function softClick(){
      try{
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = "triangle";
        o.frequency.value = 520;
        g.gain.value = 0.0001;
        o.connect(g);
        g.connect(ctx.destination);

        const t = ctx.currentTime;
        g.gain.setValueAtTime(0.0001, t);
        g.gain.exponentialRampToValueAtTime(0.12, t + 0.01);
        g.gain.exponentialRampToValueAtTime(0.0001, t + 0.07);

        o.start(t);
        o.stop(t + 0.08);
        setTimeout(()=>ctx.close(), 120);
      }catch(e){/* silencio elegante */}
    }

    function burstParticles(){
      const host = document.getElementById("particles");
      const env = document.getElementById("env");
      const rect = env.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;

      const n = 22;
      for(let i=0;i<n;i++){
        const el = document.createElement("span");
        el.className = "p";

        const a = (Math.PI * 2) * (i/n) + (Math.random()*0.35);
        const r0 = 0;
        const r1 = 120 + Math.random()*70;

        const x0 = cx + (Math.cos(a)*r0);
        const y0 = cy + (Math.sin(a)*r0);
        const x1 = cx + (Math.cos(a)*r1);
        const y1 = cy + (Math.sin(a)*r1);

        el.style.left = "0px";
        el.style.top  = "0px";
        el.style.setProperty("--x0", `${x0}px`);
        el.style.setProperty("--y0", `${y0}px`);
        el.style.setProperty("--x1", `${x1}px`);
        el.style.setProperty("--y1", `${y1}px`);
        el.style.animationDelay = (Math.random()*90) + "ms";

        host.appendChild(el);
        setTimeout(()=>el.remove(), 1000);
      }
    }

    function openInvite(){
      if(opened) return;
      opened = true;

      const env = document.getElementById("env");
      env.classList.add("breaking");

      softClick();
      burstParticles();

      // Romper sello -> luego abrir tapa
      setTimeout(()=>{
        env.classList.add("open");
      }, 420);

      // Pequeña pausa para disfrutar la animación antes de entrar
      setTimeout(()=>{
        const params = new URLSearchParams(window.location.search);
        const code = params.get("code") || "";
        const join = code ? ("?code=" + encodeURIComponent(code) + "&intro=0") : ("?intro=0");
        window.location.href = "/" + join;
      }, 1750);
    }

    document.addEventListener("keydown",(e)=>{
      if(e.key === "Enter" || e.key === " ") openInvite();
    });
  </script>
</body>
</html>
